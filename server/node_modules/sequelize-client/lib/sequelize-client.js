exports.module = function () {

    var App = require('express')
    var app = App();
    var http = require('http');

    var DB = require('sequelize');
    var db = new DB('moodz', 'root', 'root');
    var models = {
        message: db.import(__dirname + '/models/message')
    }
    models.message.sync();
    package.json
    var api = require('sequelize-restful');
    app.configure(function () {
        app.use(api(db, { /* options */ }))
    })

    app.use(App.static(__dirname + '/public'));

    var server = http.createServer(app);
    server.listen(8080);

    var io = require('socket.io').listen(server);

    var sockets = {};
    sockets.message = io.of('/message');

    io.set('loglevel', 10) // set log level to get all debug messages
    sockets.message.on('connection', function (socket) {
        socket.emit('init', {msg: "Message Subscriber Connected..."})
    })

    app.get('/', function (req, res) {
        res.render('index.jade')
    })

    models.message.addHook('afterCreate', function (result, next) {
        sockets.message.emit('afterCreate', result);
        next(result);
    });
    models.message.addHook('afterDelete', function (result, next) {
        sockets.message.emit('afterDelete', result);
        next(result);
    });
}